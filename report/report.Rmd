---
title: "__Zusammenfassung der Experimente und Auswertung__"
output:
  html_notebook
---

```{r}
library(RHotStuff)
library(ggplot2)
library(magrittr)
```


## __Charakterisierung der Bauteile__

### __Linearpolarisatoren__

#### __Experiment__

Es werden zwei Experimente durchgeführt:

1. Nullpunktbestimmung: Welche Position des Linearpolarisators ist parallel/orthogonal zum Laser?
2. Transmissionsverhalten: Ist der Linearpolarisator unterschiedlich durchlässig für einen parallel polarisierten Laser, wenn sowohl der Laser als auch der Polarisator im gleichen Maß gedreht werden?

__Nullpunktsbestimmung von Linearpolarisatoren__:

![Aufbau Nullpunktsbestimmung](./img/aufbau_nullpunktPolarisator.png)

Durchführung:

+ Auxilliar Polarisator parallel zum Laser ausrichten
+ Leistung für verschiedene Rotationen des zu charakterisierenden Polarisators

__Transmissionsverhalten von Linearpolarisatoren__ (Variante eine Fiberbench):

![Aufbau Transmissionsverhalten von Linearpolarisatoren (A: Egtl. Messung, B: Normierung)](./img/aufbau_transmissionPolarisator-1.png)

Durchführung:

+ Verwendet für Polarisatoren, die nur eine Position in der Fiberbench einnehmen
+ Für beliebige Positionen der Wellenplatte werden folgende Schritte wiederholt
+ Der auxilliare Polarisator wird so gedreht, dass die Transmission maximal ist
+ Der zu charaktarisierende Polarisator wird so gedreht, dass die Transmission maximal ist
+ Leistung wird vor und hinter den zu charakterisierenden Polarisator gemessen

__Transmissionsverhalten von Linearpolarisatoren__ (Variante zwei Fiberbenches):

![Aufbau Transmissionsverhalten von Linearpolarisatoren (A: Egtl. Messung, B: Normierung)](./img/aufbau_transmissionPolarisator-2.png)

Durchführung:

+ Für beliebige Positionen des zu charakterisierenden Linearpolarisators wird der Auxilliarpolarisator auf maximale Transmission gedreht
+ Die Leistung wird vor und hinter dem zu charakterisierenden Polarisator gemessen



#### __Auswertung__

__Nullpunktbstimmung__

+ Herunterladen von Messdaten
+ Normalisieren der Daten mit der Leistung gemessen ohne Linearpolarisator
```{r}
#
# LINEARPOLARISATOR P1
#
# Extract Data from eLabFTW
P1.maxmin.metadata <- GET.elabftw.byselector(25, node.selector = "#meta-data")[[1]]
P1.maxmin.data <- GET.elabftw.byselector(25, header = T)[[1]]

# Normalise data
P1.maxmin.data$Y1 <- P1.maxmin.data$Y1 / P1.maxmin.metadata[3,2] *100

#
# LINEARPOLARISATOR P2
#
# Extract Data from eLabFTW
P2.maxmin.metadata <- GET.elabftw.byselector(26, node.selector = "#meta-data")[[1]]
P2.maxmin.data <- GET.elabftw.byselector(26, header = T)[[1]]

# Normalise data
P2.maxmin.data$Y1 <- P2.maxmin.data$Y1 / P2.maxmin.metadata[3,2] *100
```

__Winkelabhängige Transmission__

+ Herunterladen der Messdaten
+ Ggf. .csv Dateien auslesen und den Mittelwert (unter Vernachlässigung der ersten und letzten 10%-Quantille) der gemessenen Leistungen nehmen
+ Normalisieren mit der Leistung hinter dem Polarisator mit der Leistung vor dem Polarisator

```{r}
#
# LINEARPOLARISATOR P1
#
# Extract data from eLabFTW
P1.transmission.data <- GET.elabftw.byselector(29, header = T)[[1]]

# Normalise data
P1.transmission.data$Y4 <- P1.transmission.data$Y4/P1.transmission.data$Y2 *100

#
# LINEARPOLARISATOR P2
#
# Extract data from eLabFTW
P2.transmission.data <- GET.elabftw.byselector(30, header = T)[[1]]

# Normalise data
P2.transmission.data$Y4 <- P2.transmission.data$Y4/P2.transmission.data$Y2 *100

#
# LINEARPOLARISATOR P3
#
# Extract data from elabFTW
P3.absorbance <- GET.elabftw.bycaption(78, header=T, outputHTTP=T) %>% 
                  parseTable.elabftw(., func=function(x) qmean(x[,4], 0.8, na.rm=T, inf.rm=T),
                                     header=T, skip=14, sep=";") %>% 
                  .[[1]]
colnames(P3.absorbance) <- c("P3", "P4", "background", "measured")

# Normalise data
P3.absorbance$transmittance <- P3.absorbance$measured / P3.absorbance$background
```


##### __Linearpolarisator P1__

```{r}
# Plot Zero Point
ggplot(data = P1.maxmin.data, mapping = aes(x = X, y = Y1)) +
  geom_point(size = 0.5) +
  theme_minimal() +
  labs(title = "Die Durchlässigkeit des Linearpolarisators P1 in Abhänigkeit des Rotationswinkels",
       x = "Winkel / °",
       y = "Anteil der Strahlung, die den Polarisator passiert / %")

# Plot Transmissionsverhalten
ggplot(data = P1.transmission.data, mapping = aes(x = Y3, y = Y4)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Winkelabhängige Transmission von Linearpolarisator P1",
       x = "Rotationswinkel / °",
       y = "Anteil der Strahlung, die den Polarisator passieren / %")

```
__Fazit:__

+ Rotation parallel zu Laser: 6°, 192°
+ Rotation orthogonal zu Laser: 102°, 280°
+ Transmissionsverhalten schwankt wenig und scheint keinem Muster zu folgen (+/- 0.5%?)
+ Transmittiert ca. 85.6%

##### __Linearpolarisator P2__

```{r}
# Plot Zero Point
ggplot(data = P2.maxmin.data, mapping = aes(x = X, y = Y1)) +
  geom_point(size = 0.5) +
  theme_minimal() +
  labs(title = "Die Durchlässigkeit des Linearpolarisators P2 in Abhänigkeit des Rotationswinkels",
       x = "Winkel / °",
       y = "Anteil der Strahlung, die den Polarisator passiert / %")

# Plot Transmissionsverhalten
ggplot(data = P2.transmission.data, mapping = aes(x = Y3, y = Y4)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Winkelabhängige Transmission von Linearpolarisator P2",
       x = "Rotationswinkel / °",
       y = "Anteil der Strahlung, die den Polarisator passieren / %")

```
__Fazit:__

+ Rotation parallel zu Laser: 158°, 340°
+ Rotation orthogonal zu Laser: 72°, 250°
+ Transmissionsverhalten schwankt wenig und scheint keinem Muster zu folgen (+/- 0.5%?)
+ Transmittiert ca. 86.2%

##### __Linearpolarisator P3__

```{r}
# Plot transmission behaviour
# Does the transmittance of the linear polariser change when rotating the polariser and the laser in the same manner?
ggplot(data = P3.absorbance,
       mapping = aes(x = P3, y = transmittance*100) ) +
  geom_bar(stat="identity") +
  theme_classic() +
  theme( axis.text = element_text(size=12),
         axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
         panel.grid.major.y = element_line("black", size = 0.1),
         panel.grid.minor.y = element_line("grey", size = 0.5) ) +
  scale_y_continuous(expand = c(0,0)) +
  scale_x_continuous(breaks = P3.absorbance$P3) +
  labs(title = expression(bold("The maximal transmittance of the linear polariser P3")),
       x = expression(bold("rotation of P3 or the lasers plane of polarisation / °")),
       y = expression(bold("transmittance / %"))
       )

```
__Fazit:__

+ Transmission schwankt wenig (stärker als P1/P2) und scheint keinem Muster zu folgen (+/- 1% bis zu 2.5%)
+ Transmittiert ca. 60% (weniger als P1/P2)








### __Wellenplatten__

#### __Experiment__

Es werden zwei Experimente durchgeführt:

1. Nullpunktsbestimmung: Wie muss die Wellenplatte orientiert sein, um die Laserpolarisation um 90° zu drehen?
2. Transmissionsverhalten: Absorbiert die Wellenplatte unterschiedlich für verschiedene Orientierungen der Wellenplatte?

__Nullpunktbestimmung von Wellenplatten:__

![Aufbau Nullpunktbestimmung von Wellenplatten (A: Egtl. Messung, B: Normierung)](./img/aufbau_nullpunktWellenplatte.png)

Durchführung:

+ Der erste Linearpolarisator wird parallel zum Laser ausgerichtet
+ Der zweite Linearpolarisator wird orthogonal zum Laser ausgerichtet
+ Für verschiedene Positionen der Wellenplatte wird die Leistung sowohl mit als auch ohne Wellenplatte gemessen

__Winkelabhängiges Transmissionsverhalten von Wellenplatten:__

![Aufbau Transmissionsverhalten von Wellenplatten (A: Egtl. Messung, B: Normierung)](./img/aufbau_transmissionWellenplatte.png)

Durchführung:

+ Der Linearpolarisator wird parallel zum Laser ausgerichtet
+ Für verschiedene Positionen der Wellenplatte wird die Leistung vor und hinter der Wellenplatte gemessen



#### __Auswertung__

__Nullpunkt/Transmissionsverhalten:__

+ Herunterladen der Messdaten
+ Sich wiederholende Daten sind mit NA abgekürzt -> Ersetzen von NA duch die letzte Zahl in der Spalte
+ Normalisieren der Messwerte mit der Leistung ohne der Wellenplatte

```{r}
#
# Wave Plate W1
#
# Extract data from eLabFTW
W1.data <- GET.elabftw.byselector(27, header = T)[[1]]

# Replace NA values by using the previous value in the vector
fillVector <- function(vector) {
  for (index in seq_along(vector)) {
    if (is.na(vector[index])) { vector[index] <- vector[index-1] }
  }
  return(vector)
}
W1.data$Y2 <- fillVector(W1.data$Y2)
W1.data$Y4 <- fillVector(W1.data$Y4)

# Normalise
W1.data$Y1 <- (W1.data$Y1/W1.data$Y2) *100
W1.data$Y3 <- (W1.data$Y3/W1.data$Y4) *100

#
# Wave Plate W2
#
# Extract data from eLabFTW
W2.data <- GET.elabftw.byselector(28, header = T)[[1]]

# Replace NA values by using the previous value in the vector
fillVector <- function(vector) {
  for (index in seq_along(vector)) {
    if (is.na(vector[index])) { vector[index] <- vector[index-1] }
  }
  return(vector)
}
W2.data$Y2 <- fillVector(W2.data$Y2)
W2.data$Y4 <- fillVector(W2.data$Y4)

# Normalise
W2.data$Y1 <- (W2.data$Y1/W2.data$Y2) *100
W2.data$Y3 <- (W2.data$Y3/W2.data$Y4) *100
```


##### __Wellenplatte W1__

```{r}
# Plot Transmissionverhalten
ggplot(data = W1.data, mapping = aes(x = X, y=Y3)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Durchlässigkeit der Wellenplatte W1 in Abhängigkeit des Rotationswinkels",
       x = "Rotationswinkel / °",
       y = "Anteil der Strahlung, die die Wellenplatte passiert / %")
# Plot Nullpunktsbestimmung
ggplot(data = W1.data, mapping = aes(x=X, y=Y1)) +
  geom_point(size=0.5) +
  theme_minimal() +
  labs(title = "Nullpunktsbestimmung der Wellenplatte W1",
       x = "Rotationswinkel / °",
       y = "Gesteigerte Transmission durch die Wellenplatte / %")

```

__Fazit:__

+ Wellenplatte rotiert Polarisation um  0° bei:       358°,  90°, 180°, 268°
+ Wellenplatte rotiert Polarisation um 90° bei: ~[40°;50°], 134°, 224°, 314°
+ Wellenplatte transmittiert gut (~98%)
+ Transmission schwankt ein wenig (bis zu 2.3%)
+ Transmission scheint bei großen Rotationswinkeln zu sinken; es gibt allerdings viele Ausreißer


##### __Wellenplatte W2__

```{r}
# Plot Transmissionsverhalten
ggplot(data = W2.data, mapping = aes(x = X, y=Y3)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Durchlässigkeit der Wellenplatte W2 in Abhängigkeit des Rotationswinkels",
       x = "Rotationswinkel / °",
       y = "Anteil der Strahlung, die die Wellenplatte passiert / %")
# Plot Nullpunktbestimmung
ggplot(data = W2.data, mapping = aes(x=X, y=Y1)) +
  geom_point(size=0.5) +
  theme_minimal() +
  labs(title = "Nullpunktsbestimmung der Wellenplatte W2",
       x = "Rotationswinkel / °",
       y = "Gesteigerte Transmission durch die Wellenplatte / %")
```

+ Wellenplatte rotiert Polarisation um  0° bei: 350°,  82°, 172°, 262°
+ Wellenplatte rotiert Polarisation um 90° bei:  42°, 128°, 216°, 206°
+ Wellenplatte transmittiert sehr gut (~96.5%)
+ Transmission schwankt ein wenig (bis zu 2.3%)
+ Transmission verhält sich vielleicht periodisch? Es gibt allerdings viele Ausreißer.



### __Optische Fasern__

#### __Experiment__

Es werden drei Experimente durchgeführt:

1. Messung der Stokesvektoren: Die Stokesvektoren werden vor und nach Passieren der optischen Faser für verschiedene Laserpolarisationen bestimmt
2. Messfehler der Stokesvektoren: Die Stokesvektoren werden wiederholt für die selbe initiale Laserpolarisation gemessen, um den Messfehler abzuschätzen
3. Rotation der Polarisationsebene: Es wird gemessen wie stark und in welche Richtung die Faser die Polarisationsebene des Lasers dreht

__Messung der Stokesvektoren:__

![Aufbau Messung Stokesvektoren (A: Stokes hinter der Faser, B: Normierung hinter der Faser, C: Stokes vor der Faser, D: Normierung vor der Faser)](./img/aufbau_stokesFaser.png)

Duchführung:

+ 

#### __Auswertung__
Wie erfolgt Auswertung?

##### __PM-Faser F1__
Plot/Diskussion

##### __SM-Faser F2__
Plot/Diskussion

##### __MM-Faser F3__
Plot/Diskussion

### __WiTec-Detektor__

#### __Experiment__
Aufbau/Durchführung

#### __Auswertung__
Wie erfolgt Auswertung?
Plot/Diskussion/Mit und ohne Mikriskop


## __Polarisaionsabhängige Ramanspektroskopie am WiTec__
Aufbau/Durchführung

### __Ramanspektren von Tetrachlormethan__
Plot/Diskussion